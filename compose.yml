services:
    api-gateway:
        build:
            context: ./services/api-gateway
            containerfile: Containerfile
        ports:
            - "${API_GATEWAY_PORT:-50051}:${API_GATEWAY_PORT:-50051}"
        volumes:
            - proto:/app/proto:ro
        env_file:
            - .env

    whisper-service:
        build:
            context: ./services/whisper-service
            containerfile: Containerfile
        ports:
            - "${WHISPER_SERVICE_PORT:-50052}:${WHISPER_SERVICE_PORT:-50052}"
        volumes:
            - proto:/app/proto:ro
        env_file:
            - .env

    telegram-bot:
        build:
            context: ./services/telegram-bot
            containerfile: Containerfile
        volumes:
            - proto:/app/proto:ro
        env_file:
            - .env

volumes:
    proto:
        driver: local
        driver_opts:
            type: none
            o: bind
            device: ./proto
