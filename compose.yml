services:
    api-gateway:
        build:
            context: ./services/api-gateway
            containerfile: Containerfile
        ports:
            - "${API_GATEWAY_PORT:-50051}:${API_GATEWAY_PORT:-50051}"
        env_file:
            - .env

    whisper-service:
        build:
            context: ./services/whisper-service
            containerfile: Containerfile
        ports:
            - "${WHISPER_SERVICE_PORT:-50052}:${WHISPER_SERVICE_PORT:-50052}"
        env_file:
            - .env

    telegram-bot:
        build:
            context: ./services/telegram-bot
            containerfile: Containerfile
        ports:
            - "${TELEGRAM_BOT_PORT:-50053}:${TELEGRAM_BOT_PORT:-50053}"
        env_file:
            - .env

    redis:
        image: docker.io/library/redis:8.2.2-alpine
        restart: unless-stopped
        ports:
            - "${REDIS_PORT:-6379}:${REDIS_PORT:-6379}"
        volumes:
            - redis-data:/data

    minio:
        image: docker.io/minio/minio:latest
        ports:
            - "${MINIO_PORT}:${MINIO_PORT}"
            - "${MINIO_CONSOLE_PORT}:${MINIO_CONSOLE_PORT}"
        environment:
            MINIO_ROOT_USER: minioadmin
            MINIO_ROOT_PASSWORD: minioadmin
        command: server --console-address ":${MINIO_CONSOLE_PORT}" /data
        volumes:
            - minio-data:/data

volumes:
    redis-data:
        driver: local
    minio-data:
        driver: local
