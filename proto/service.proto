// service.proto
// gRPC API definitions for LYRA microservices

syntax = "proto3";

package lyra;

option go_package = "internal/pb";

service WhisperService {
    // Transcribe audio/video file
    rpc Transcribe(TranscribeRequest) returns (TranscribeResponse);
    // Health check endpoint
    rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
    // Create asynchronous transcription task
    rpc CreateTranscriptionTask(TranscribeRequest) returns (CreateTaskResponse);
    // Get status/result of asynchronous task
    rpc GetTaskStatus(GetTaskStatusRequest) returns (GetTaskStatusResponse);
}

message TranscribeRequest {
    // Audio or video file content (raw bytes)
    bytes file_content = 1;
    // File name or metadata (optional)
    string file_name = 2;
}

message TranscribeResponse {
    // Transcribed text
    string text = 1;
    // Error message (optional)
    string error = 2;
}

message HealthCheckRequest {}
message HealthCheckResponse {
    string status = 1;
}

// Response for async task creation
message CreateTaskResponse {
    string task_id = 1;
    string error = 2;
}

// Request for task status
message GetTaskStatusRequest {
    string task_id = 1;
}

// Response for task status
message GetTaskStatusResponse {
    string status = 1;
    string result = 2;
    string error = 3;
    int64 created_at = 4;
    int64 updated_at = 5;
}
